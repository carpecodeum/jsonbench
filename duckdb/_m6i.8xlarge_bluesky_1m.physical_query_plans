------------------------------------------------------------------------------------------------------------------------
Physical query plan for query Q1:


┌─────────────────────────────┐
│┌───────────────────────────┐│
││       Physical Plan       ││
│└───────────────────────────┘│
└─────────────────────────────┘
┌───────────────────────────┐
│          ORDER_BY         │
│    ────────────────────   │
│     count_star() DESC     │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│         Groups: #0        │
│                           │
│        Aggregates:        │
│        count_star()       │
│                           │
│        ~500000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│           event           │
│                           │
│       ~1000000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│    ────────────────────   │
│       Table: bluesky      │
│   Type: Sequential Scan   │
│       Projections: j      │
│                           │
│       ~1000000 Rows       │
└───────────────────────────┘
------------------------------------------------------------------------------------------------------------------------
Physical query plan for query Q2:


┌─────────────────────────────┐
│┌───────────────────────────┐│
││       Physical Plan       ││
│└───────────────────────────┘│
└─────────────────────────────┘
┌───────────────────────────┐
│          ORDER_BY         │
│    ────────────────────   │
│     count_star() DESC     │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│         Groups: #0        │
│                           │
│        Aggregates:        │
│        count_star()       │
│     count(DISTINCT #1)    │
│                           │
│        ~100000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│           event           │
│      (j ->> '$.did')      │
│                           │
│        ~200000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│    ────────────────────   │
│       Table: bluesky      │
│   Type: Sequential Scan   │
│       Projections: j      │
│                           │
│          Filters:         │
│    ((j ->> '$.kind') =    │
│  'commit') AND ((j ->> '$ │
│   .commit.operation') =   │
│         'create')         │
│                           │
│        ~200000 Rows       │
└───────────────────────────┘
------------------------------------------------------------------------------------------------------------------------
Physical query plan for query Q3:


┌─────────────────────────────┐
│┌───────────────────────────┐│
││       Physical Plan       ││
│└───────────────────────────┘│
└─────────────────────────────┘
┌───────────────────────────┐
│          ORDER_BY         │
│    ────────────────────   │
│ "hour"(to_timestamp((CAST(│
│ (db.main.bluesky.j ->> '$ │
│  .time_us') AS BIGINT) /  │
│       1000000))) ASC      │
│ (db.main.bluesky.j ->> '$ │
│  .commit.collection') ASC │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│          Groups:          │
│             #0            │
│             #1            │
│                           │
│        Aggregates:        │
│        count_star()       │
│                           │
│        ~100000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│           event           │
│        hour_of_day        │
│                           │
│        ~200000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│    ────────────────────   │
│       Table: bluesky      │
│   Type: Sequential Scan   │
│       Projections: j      │
│                           │
│          Filters:         │
│  contains(['app.bsky.feed │
│   .post', 'app.bsky.feed  │
│  .repost', 'app.bsky.feed │
│ .like'], (j ->> '$.commit │
│ .collection')) AND ((j ->>│
│  '$.kind') = 'commit') AND│
│      ((j ->> '$.commit    │
│  .operation') = 'create') │
│                           │
│        ~200000 Rows       │
└───────────────────────────┘
------------------------------------------------------------------------------------------------------------------------
Physical query plan for query Q4:


┌─────────────────────────────┐
│┌───────────────────────────┐│
││       Physical Plan       ││
│└───────────────────────────┘│
└─────────────────────────────┘
┌───────────────────────────┐
│           TOP_N           │
│    ────────────────────   │
│           Top: 3          │
│                           │
│         Order By:         │
│ to_timestamp((CAST(min((db│
│   .main.bluesky.j ->> '$  │
│  .time_us')) AS BIGINT) / │
│        1000000)) ASC      │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│             0             │
│      first_post_date      │
│                           │
│        ~100000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│         Groups: #0        │
│    Aggregates: min(#1)    │
│                           │
│        ~100000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│          user_id          │
│    (j ->> '$.time_us')    │
│                           │
│        ~200000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│    ────────────────────   │
│       Table: bluesky      │
│   Type: Sequential Scan   │
│       Projections: j      │
│                           │
│          Filters:         │
│    ((j ->> '$.kind') =    │
│  'commit') AND ((j ->> '$ │
│   .commit.operation') =   │
│  'create') AND ((j ->> '$ │
│  .commit.collection') =   │
│   'app.bsky.feed.post')   │
│                           │
│        ~200000 Rows       │
└───────────────────────────┘
------------------------------------------------------------------------------------------------------------------------
Physical query plan for query Q5:


┌─────────────────────────────┐
│┌───────────────────────────┐│
││       Physical Plan       ││
│└───────────────────────────┘│
└─────────────────────────────┘
┌───────────────────────────┐
│           TOP_N           │
│    ────────────────────   │
│           Top: 3          │
│                           │
│         Order By:         │
│ date_diff('milliseconds', │
│   to_timestamp((CAST(min( │
│ (db.main.bluesky.j ->> '$ │
│  .time_us')) AS BIGINT) / │
│  1000000)), to_timestamp( │
│ (CAST(max((db.main.bluesky│
│  .j ->> '$.time_us')) AS  │
│  BIGINT) / 1000000))) DESC│
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│             0             │
│       activity_span       │
│                           │
│        ~100000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│         Groups: #0        │
│                           │
│        Aggregates:        │
│          min(#1)          │
│          max(#2)          │
│                           │
│        ~100000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│          user_id          │
│             #1            │
│             #1            │
│                           │
│        ~200000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│             j             │
│    (j ->> '$.time_us')    │
│                           │
│        ~200000 Rows       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│    ────────────────────   │
│       Table: bluesky      │
│   Type: Sequential Scan   │
│       Projections: j      │
│                           │
│          Filters:         │
│    ((j ->> '$.kind') =    │
│  'commit') AND ((j ->> '$ │
│   .commit.operation') =   │
│  'create') AND ((j ->> '$ │
│  .commit.collection') =   │
│   'app.bsky.feed.post')   │
│                           │
│        ~200000 Rows       │
└───────────────────────────┘
